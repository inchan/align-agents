# Tools UI 시나리오 테스트

## 목차

- [개요](#개요)
- [테스트 환경](#테스트-환경)
- [기능 매트릭스](#기능-매트릭스)
- [우선순위 정의](#우선순위-정의)
- [시나리오 목록](#시나리오-목록)
  - [T-001: 도구 목록 페이지 렌더링](#t-001-도구-목록-페이지-렌더링)
  - [T-001-A: 도구 목록 빈 상태 표시](#t-001-a-도구-목록-빈-상태-표시)
  - [T-002: 설치됨/미설치 필터링](#t-002-설치됨미설치-필터링)
  - [T-003: 커스텀 도구 추가 (성공)](#t-003-커스텀-도구-추가-성공)
  - [T-004: 커스텀 도구 추가 (실패)](#t-004-커스텀-도구-추가-실패)
  - [T-004-A: 도구 추가 경로 유효성 검증](#t-004-a-도구-추가-경로-유효성-검증)
  - [T-005: 커스텀 도구 삭제](#t-005-커스텀-도구-삭제)
  - [T-005-A: Built-in 도구 삭제 방지](#t-005-a-built-in-도구-삭제-방지)
  - [T-006: 도구 설정(Config) 편집](#t-006-도구-설정config-편집)
  - [T-007: Help 명령어 출력 확인](#t-007-help-명령어-출력-확인)
  - [T-008: Open MCP 메뉴 동작](#t-008-open-mcp-메뉴-동작)
- [테스트 데이터 Setup](#테스트-데이터-setup)
- [테스트 실행 방법](#테스트-실행-방법)
- [버전 이력](#버전-이력)

---

## 개요

이 문서는 align-agents의 **도구 관리 페이지** UI 시나리오 테스트를 정의합니다.
`ToolsPage.tsx` 컴포넌트의 도구 목록 조회, 커스텀 도구 추가/삭제, 설정 편집 기능을 커버합니다.

> **범위**: Tools 메뉴 내 기능만 다룹니다. MCP 설정은 별도 문서에서 다룹니다.

---

## 테스트 환경

- **도구**: Playwright
- **대상 페이지**: `/tools`
- **베이스 URL**: http://localhost:5173
- **API 서버**: http://localhost:3001

---

## 기능 매트릭스

| 기능 | 시나리오 번호 | 우선순위 |
|------|---------------|----------|
| 도구 목록 렌더링 | T-001 | P0 |
| 빈 상태 표시 | T-001-A | P0 |
| 설치됨/미설치 필터링 | T-002 | P1 |
| 커스텀 도구 추가 | T-003, T-004, T-004-A | P0 |
| 커스텀 도구 삭제 | T-005, T-005-A | P0 |
| 도구 설정 편집 | T-006 | P0 |
| Help 명령어 출력 | T-007 | P1 |
| Open MCP 메뉴 | T-008 | P1 |

---

## 우선순위 정의

| 우선순위 | 설명 | 릴리즈 기준 |
|----------|------|-------------|
| **P0** | 핵심 기능, 데이터 무결성 | 필수 통과 |
| **P1** | 에러 처리, UX 안전장치 | 권장 통과 |
| **P2** | 부가 기능, 접근성 | 시간 허용 시 |

---

## 시나리오 목록

### T-001: 도구 목록 페이지 렌더링

**우선순위**: P0
**카테고리**: Core

**목적**: Tools 페이지 접속 시 도구 목록이 올바르게 표시되는지 확인

**전제 조건**:
- API 서버 실행 중
- 최소 1개 이상의 도구 존재 (built-in 또는 custom)

**테스트 단계**:
1. `/tools` 페이지 접속
2. 페이지 헤더에 "도구 관리" 타이틀 확인
3. 도구 목록이 카드 형태로 표시되는지 확인
4. 각 도구 카드에 표시되는 정보 확인:
   - 도구 이름
   - 설정 파일 경로
   - 설치 상태 인디케이터 (초록색/회색 점)
   - 더보기 메뉴 버튼

**예상 결과**:
- [ ] "도구 관리" 헤더 표시
- [ ] "Add Tool" 버튼 표시
- [ ] 도구 카드 목록이 그리드 레이아웃으로 표시
- [ ] 각 카드에 필수 정보 표시
- [ ] 설치된 도구는 초록색 점, 미설치는 회색 점 표시

**API 검증**:
- [ ] `GET /api/tools` 호출 성공 (200)

---

### T-001-A: 도구 목록 빈 상태 표시

**우선순위**: P0
**카테고리**: Edge

**목적**: 도구가 없을 때 적절한 안내가 표시되는지 확인

**전제 조건**:
- API 서버에 등록된 도구가 없는 상태

**테스트 단계**:
1. `/tools` 페이지 접속
2. 빈 상태 UI 확인

**예상 결과**:
- [ ] "도구 관리" 헤더는 여전히 표시
- [ ] "Add Tool" 버튼 표시
- [ ] 도구 카드 영역이 비어있거나 빈 상태 메시지 표시

---

### T-002: 설치됨/미설치 필터링

**우선순위**: P1
**카테고리**: Feature

**목적**: 도구 목록이 설치 상태별로 정렬되는지 확인

**전제 조건**:
- 설치된 도구와 미설치 도구가 모두 존재

**테스트 단계**:
1. `/tools` 페이지 접속
2. 도구 목록의 순서 확인

**예상 결과**:
- [ ] 설치된 도구(exists: true)가 목록 상단에 표시
- [ ] 미설치 도구(exists: false)가 목록 하단에 표시
- [ ] 같은 설치 상태 내에서는 이름순으로 정렬

---

### T-003: 커스텀 도구 추가 (성공)

**우선순위**: P0
**카테고리**: Core

**목적**: 새 커스텀 도구 추가가 정상적으로 작동하는지 확인

**테스트 단계**:
1. `/tools` 페이지 접속
2. "Add Tool" 버튼 클릭
3. Add Custom Tool 모달 표시 확인
4. 다음 정보 입력:
   - Tool Name: `My Custom Tool`
   - Config Path: `/tmp/config.json`
   - (선택) Rules Path, MCP Config Path, Description
5. "Add Tool" 버튼 클릭
6. 토스트 메시지 확인
7. 모달이 닫히는지 확인
8. 목록에 새 도구가 추가되는지 확인

**예상 결과**:
- [ ] 모달에 모든 입력 필드 표시
- [ ] 도구 추가 성공
- [ ] 토스트 메시지 표시: "Tool added" 또는 유사
- [ ] 모달 닫힘
- [ ] 목록에 새 도구 즉시 표시
- [ ] 새 도구에 "Custom" 배지 표시

**API 검증**:
- [ ] `POST /api/tools` 호출 성공 (200/201)

---

### T-004: 커스텀 도구 추가 (실패)

**우선순위**: P0
**카테고리**: Validation

**목적**: 필수 필드 없이 도구 추가 시 실패하는지 확인

**테스트 단계**:
1. Add Custom Tool 모달 열기
2. Tool Name 필드 비워두기
3. "Add Tool" 버튼 상태 확인

**예상 결과**:
- [ ] Tool Name이 비어있으면 "Add Tool" 버튼 비활성화 (disabled)
- [ ] 도구 추가 불가

---

### T-004-A: 도구 추가 경로 유효성 검증

**우선순위**: P1
**카테고리**: Validation

**목적**: 선택적 경로 필드들의 유효성 확인

**테스트 단계**:
1. Add Custom Tool 모달 열기
2. Tool Name 입력: `Test Tool`
3. Config Path, Rules Path, MCP Path 각각 유효하지 않은 경로 입력
4. "Add Tool" 버튼 클릭

**예상 결과**:
- [ ] 경로 필드들은 선택사항이므로 빈 상태에서도 추가 가능
- [ ] 유효하지 않은 경로도 클라이언트에서는 허용 (서버에서 검증)
- [ ] 서버 오류 시 에러 토스트 표시

---

### T-005: 커스텀 도구 삭제

**우선순위**: P0
**카테고리**: Core

**목적**: 커스텀 도구 삭제가 정상적으로 작동하는지 확인

**전제 조건**:
- 삭제 가능한 커스텀 도구 존재

**테스트 단계**:
1. `/tools` 페이지 접속
2. 커스텀 도구 카드의 더보기(⋮) 버튼 클릭
3. 드롭다운 메뉴에서 "Delete" 클릭
4. 토스트 메시지 확인
5. 목록에서 도구가 제거되는지 확인

**예상 결과**:
- [ ] 커스텀 도구의 드롭다운에 Delete 옵션 표시
- [ ] Delete 클릭 시 즉시 삭제 (확인 없이)
- [ ] 삭제 성공 토스트 표시: "Tool deleted"
- [ ] 목록에서 도구 제거

**API 검증**:
- [ ] `DELETE /api/tools/:id` 호출 성공 (200)

---

### T-005-A: Built-in 도구 삭제 방지

**우선순위**: P0
**카테고리**: Validation

**목적**: Built-in 도구는 삭제 불가능한지 확인

**전제 조건**:
- Built-in 도구 존재 (cursor, vscode, windsurf, claude-desktop, zed)

**테스트 단계**:
1. `/tools` 페이지 접속
2. Built-in 도구 카드의 더보기(⋮) 버튼 클릭
3. 드롭다운 메뉴 확인

**예상 결과**:
- [ ] Built-in 도구의 드롭다운에 Delete 옵션 없음
- [ ] "Custom" 배지가 없는 도구는 삭제 불가

---

### T-006: 도구 설정(Config) 편집

**우선순위**: P0
**카테고리**: Core

**목적**: 도구의 설정 파일을 편집하는 기능 확인

**전제 조건**:
- configPath가 설정된 설치된 도구 존재

**테스트 단계**:
1. `/tools` 페이지 접속
2. 설치된 도구 카드의 "설정 편집" 버튼 클릭
3. ConfigEditorModal 표시 확인
4. 설정 편집 모달 닫기

**예상 결과**:
- [ ] 설치된 도구에 "설정 편집" 버튼 표시
- [ ] 버튼 클릭 시 ConfigEditorModal 표시
- [ ] configPath가 없는 도구는 버튼 비활성화

**대안 경로**:
1. 드롭다운 메뉴에서 "Edit Config" 클릭으로도 동일 동작

---

### T-007: Help 명령어 출력 확인

**우선순위**: P1
**카테고리**: Feature

**목적**: 도구의 --help 명령어 출력을 확인하는 기능 테스트

**전제 조건**:
- 설치된 도구 존재 (exists: true)

**테스트 단계**:
1. `/tools` 페이지 접속
2. 설치된 도구 카드의 더보기(⋮) 버튼 클릭
3. 드롭다운 메뉴에서 "Check Help" 클릭
4. HelpModal 표시 확인
5. 로딩 스피너 확인
6. help 출력 결과 확인

**예상 결과**:
- [ ] "Check Help" 메뉴 클릭 시 HelpModal 표시
- [ ] 모달에 로딩 스피너 표시
- [ ] API 응답 후 help 출력 텍스트 표시
- [ ] 출력은 monospace 폰트로 pre 태그에 표시

**API 검증**:
- [ ] `POST /api/tools/:id/help` 호출 성공 (200)

**참고**: 미설치 도구에는 "Check Help" 메뉴가 표시되지 않음

---

### T-008: Open MCP 메뉴 동작

**우선순위**: P1
**카테고리**: Feature

**목적**: Claude Desktop 도구에서 MCP 페이지로 이동하는 기능 확인

**전제 조건**:
- claude-desktop 도구 존재

**테스트 단계**:
1. `/tools` 페이지 접속
2. Claude Desktop 도구 카드의 더보기(⋮) 버튼 클릭
3. 드롭다운 메뉴에서 "Open MCP" 클릭
4. URL 해시 변경 확인

**예상 결과**:
- [ ] claude-desktop 도구에만 "Open MCP" 메뉴 표시
- [ ] 클릭 시 `#/mcp`로 해시 변경
- [ ] MCP 페이지로 이동

---

## 테스트 데이터 Setup

테스트 실행 전 다음 데이터가 준비되어야 합니다:

```
Built-in 도구 목록 (자동 제공):
- cursor
- vscode
- windsurf
- claude-desktop
- zed

테스트용 커스텀 도구 생성:
- "test-custom-tool" (configPath: /tmp/test-config.json)
```

**Setup 스크립트 예시**:
```bash
# 테스트 데이터 초기화
npm run test:setup

# E2E 테스트 실행
npm run test:e2e
```

---

## 테스트 실행 방법

```bash
# E2E 테스트 실행
cd packages/web
npm run test:e2e

# Tools 관련 테스트만 실행
npm run test:e2e -- --grep "T-00"

# 우선순위별 실행
npm run test:e2e -- --grep "P0"

# Tools 테스트 파일만 실행
npm run test:e2e -- tools/tools-core.spec.ts

# UI 모드로 실행
npm run test:e2e:ui

# 디버그 모드
npm run test:e2e:debug
```

---

## 버전 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|-----------|
| 1.0 | 2025-12-12 | 초기 작성 - 11개 시나리오 |
|     |            | - Core: T-001, T-003, T-005, T-006 (4개) |
|     |            | - Edge: T-001-A (1개) |
|     |            | - Validation: T-004, T-004-A, T-005-A (3개) |
|     |            | - Feature: T-002, T-007, T-008 (3개) |
|     |            | - 우선순위 체계 도입 (P0/P1/P2) |
