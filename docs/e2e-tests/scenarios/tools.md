# Tools 페이지 E2E 테스트 시나리오

## 1. 개요
이 문서는 align-agents의 **Tools 관리 페이지(`/tools`)**에 대한 End-to-End 테스트 시나리오를 정의합니다. 사용자가 도구(CLI Agent) 목록을 조회하고, 커스텀 도구를 추가/수정/삭제하며, 도구의 설정을 관리하는 핵심 기능을 검증합니다.

## 2. 테스트 환경
*   **Framework**: Playwright
*   **Base URL**: `http://localhost:5173`
*   **Target Route**: `/tools`
*   **Backend**: Mock Server 또는 로컬 API 서버 (데이터 상태 초기화 필요)

## 3. 우선순위 정의 (Priorities)
*   **P0 (Critical)**: 핵심 기능. 실패 시 배포 불가 (도구 목록 조회, 추가, 삭제).
*   **P1 (Major)**: 주요 기능. 사용자 경험에 큰 영향 (설정 수정, Help 조회, 유효성 검사).
*   **P2 (Minor)**: 부가 기능 및 UI 디테일 (정렬, UI 상태값 표시 등).

## 4. 기능 매트릭스

| 기능 ID | 기능명 | 시나리오 ID | 우선순위 |
| :--- | :--- | :--- | :--- |
| F-01 | 도구 목록 조회 | T-001, T-001-A, T-002 | P0, P2 |
| F-02 | 커스텀 도구 추가 | T-003, T-004, T-004-A | P0, P1 |
| F-03 | 도구 삭제 | T-005, T-005-A | P0 |
| F-04 | Config 편집 | T-006 | P1 |
| F-05 | Help 명령어 확인 | T-007 | P1 |
| F-06 | MCP 연결 확인 | T-008 | P2 |

---

## 5. 시나리오 목록

### T-001: 도구 목록 페이지 렌더링 및 조회
*   **우선순위**: P0
*   **카테고리**: 조회 (Read)
*   **목적**: `/tools` 페이지 진입 시 등록된 도구 목록이 정상적으로 표시되는지 확인한다.
*   **전제조건**: 최소 1개 이상의 도구가 백엔드에 등록되어 있어야 한다.
*   **테스트 단계**:
    1. 웹 브라우저에서 `/tools` 페이지로 이동한다.
    2. 도구 목록 컨테이너가 로드될 때까지 대기한다.
    3. 각 도구 카드의 필수 정보(이름, 상태 뱃지 등)가 표시되는지 확인한다.
*   **기대 결과**:
    *   HTTP 200 응답과 함께 페이지가 로드된다.
    *   등록된 도구의 개수만큼 리스트 아이템이 렌더링된다.

### T-001-A: 도구 목록 빈 상태 표시
*   **우선순위**: P2
*   **카테고리**: 조회 (Edge Case)
*   **목적**: 등록된 도구가 없을 때 적절한 안내 메시지를 표시하는지 확인한다.
*   **전제조건**: 백엔드가 빈 배열을 반환하도록 Mock 설정.
*   **테스트 단계**:
    1. `/tools` 페이지로 이동한다.
    2. 빈 상태 UI를 확인한다.
*   **기대 결과**:
    *   "등록된 도구가 없습니다" 또는 안내 메시지가 표시된다.
    *   **[Add Tool]** 버튼이 눈에 띄게 표시된다.
    *   레이아웃이 정상적으로 유지된다.

### T-002: 설치됨/미설치 필터링 및 정렬 확인
*   **우선순위**: P2
*   **카테고리**: 조회 (UI/UX)
*   **목적**: 도구 목록이 설치 여부에 따라 구분되거나 정렬 기능이 작동하는지 확인한다.
*   **전제조건**: 설치된 도구와 미설치된 도구가 혼재되어 있어야 한다.
*   **테스트 단계**:
    1. `/tools` 페이지 상단의 정렬/필터 옵션을 확인한다.
    2. '설치됨(Installed)' 필터 또는 정렬 기준을 변경한다.
*   **기대 결과**:
    *   선택한 기준에 맞춰 도구 목록의 순서가 변경되거나 필터링되어야 한다.

### T-003: 커스텀 도구 추가 (성공 케이스)
*   **우선순위**: P0
*   **카테고리**: 생성 (Create)
*   **목적**: 사용자가 새로운 커스텀 도구를 정상적으로 등록할 수 있는지 확인한다.
*   **전제조건**: 없음.
*   **테스트 단계**:
    1. 우측 상단의 **[Add Tool]** 버튼을 클릭하여 모달을 연다.
    2. 다음 필드를 입력한다:
        *   **Name**: `e2e-test-cli`
        *   **Description**: `E2E 테스트용 도구`
        *   **Config Path**: `/tmp/config.json`
        *   **Rules Path**: `/tmp/rules.md`
        *   **MCP Path**: `/tmp/mcp-server`
    3. **[Save]** (또는 Add) 버튼을 클릭한다.
*   **기대 결과**:
    *   API 호출(POST)이 성공(200/201)한다.
    *   모달이 닫히고 성공 토스트 메시지가 표시된다.
    *   목록에 `e2e-test-cli` 도구가 즉시 추가되어 보인다.

### T-004: 커스텀 도구 추가 유효성 검사 (실패 케이스)
*   **우선순위**: P1
*   **카테고리**: 생성 (Validation)
*   **목적**: 필수 입력값 누락 시 도구 생성을 차단하는지 확인한다.
*   **전제조건**: 없음.
*   **테스트 단계**:
    1. **[Add Tool]** 버튼을 클릭한다.
    2. `Name` 필드를 비워둔 채로 **[Save]** 버튼을 클릭한다.
*   **기대 결과**:
    *   API 요청이 전송되지 않아야 한다.
    *   `Name` 필드 하단에 "필수 입력 항목입니다" 등의 에러 메시지가 표시된다.

### T-004-A: 도구 추가 경로 유효성 검증
*   **우선순위**: P1
*   **카테고리**: 생성 (Validation)
*   **목적**: 잘못된 경로 형식 입력 시 도구 생성을 차단하는지 확인한다.
*   **전제조건**: 없음.
*   **테스트 단계**:
    1. **[Add Tool]** 버튼을 클릭한다.
    2. Config Path에 상대 경로(예: `./config.json`)를 입력한다.
    3. **[Save]** 버튼을 클릭한다.
*   **기대 결과**:
    *   "절대 경로를 입력해야 합니다" 등의 에러 메시지가 표시된다.
    *   API 요청이 전송되지 않는다.

### T-005: 커스텀 도구 삭제
*   **우선순위**: P0
*   **카테고리**: 삭제 (Delete)
*   **목적**: 등록된 커스텀 도구를 삭제할 수 있어야 하며, 기본(Built-in) 도구는 삭제가 불가능해야 한다.
*   **전제조건**: T-003에서 생성한 `e2e-test-cli` 도구가 존재해야 한다.
*   **테스트 단계**:
    1. `e2e-test-cli` 도구 카드의 **[...]** (더보기) 메뉴를 클릭한다.
    2. **[Delete]** 옵션을 선택한다.
    3. 삭제 확인 모달(Confirm)에서 **[확인]**을 클릭한다.
*   **기대 결과**:
    *   API 호출(DELETE)이 성공한다.
    *   목록에서 해당 도구가 사라진다.
    *   *(옵션)* 기본 제공 도구(예: git)의 경우 Delete 메뉴가 비활성화되어 있거나 보이지 않아야 한다.

### T-005-A: Built-in 도구 삭제 방지
*   **우선순위**: P0
*   **카테고리**: 삭제 제한 (Delete Protection)
*   **목적**: 기본 제공 도구(Built-in)는 삭제할 수 없어야 한다.
*   **전제조건**: Built-in 도구(예: claude, gemini)가 존재해야 한다.
*   **테스트 단계**:
    1. Built-in 도구 카드의 **[...]** (더보기) 메뉴를 클릭한다.
    2. **[Delete]** 옵션의 상태를 확인한다.
*   **기대 결과**:
    *   Delete 버튼이 비활성화(disabled)되어 있거나 메뉴에 표시되지 않는다.
    *   또는 클릭 시 "기본 도구는 삭제할 수 없습니다" 경고가 표시된다.

### T-006: 도구 설정(Config) 편집
*   **우선순위**: P1
*   **카테고리**: 수정 (Update)
*   **목적**: Config Editor 모달을 통해 설정을 수정하고 저장할 수 있는지 확인한다.
*   **전제조건**: 테스트 대상 도구가 존재해야 한다.
*   **테스트 단계**:
    1. 도구 메뉴에서 **[Edit Config]**를 선택한다.
    2. 에디터 모달이 열리면 설정 내용을 일부 수정한다 (예: JSON 키 값 변경).
    3. **[Save]** 버튼을 클릭한다.
*   **기대 결과**:
    *   수정 요청이 서버로 전송되고 성공한다.
    *   모달이 닫히고 변경 사항이 반영되었다는 피드백이 제공된다.

### T-007: Help 명령어 출력 확인
*   **우선순위**: P1
*   **카테고리**: 실행/조회
*   **목적**: 도구의 `--help` 실행 결과를 UI에서 확인할 수 있는지 검증한다.
*   **전제조건**: 실제 실행 가능한 도구 또는 Mock 응답이 설정된 도구.
*   **테스트 단계**:
    1. 도구 메뉴에서 **[Check Help]**를 선택한다.
    2. Help 정보가 담긴 모달(또는 Drawer)이 열리는지 확인한다.
*   **기대 결과**:
    *   해당 도구의 Help 텍스트가 포함된 UI가 표시된다.
    *   로딩 상태(스피너 등)가 적절히 표시된다.

### T-008: Open MCP 메뉴 동작
*   **우선순위**: P2
*   **카테고리**: 네비게이션
*   **목적**: 도구와 연관된 MCP 설정 페이지로 이동하는지 확인한다.
*   **전제조건**: MCP 경로가 설정된 도구.
*   **테스트 단계**:
    1. 도구 메뉴에서 **[Open MCP]**를 선택한다.
    2. 브라우저 URL이 해당 도구의 MCP 설정 페이지 또는 관련 경로로 변경되는지 확인한다.
*   **기대 결과**:
    *   올바른 URL로 네비게이션된다.

---

## 7. 테스트 실행 방법

```bash
# Tools 페이지 테스트만 실행
npm run test:e2e -- --grep "Tools"

# 또는 파일 지정 실행
npx playwright test e2e/tools/*.spec.ts
```

---

## 버전 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|-----------|
| 1.0 | 2025-12-11 | 초기 작성 - 8개 시나리오 |
| v1.1 | 2025-12-12 | T-001-A, T-004-A, T-005-A 추가, 테스트 실행 방법 섹션 추가 |
